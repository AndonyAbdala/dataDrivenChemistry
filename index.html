<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="A data driven, Quantum Mechanical understanding of Chemistry : AKA Trying to make sense of 134k quantum calculations">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>A data driven, Quantum Mechanical understanding of Chemistry</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/beangoben/dataDrivenChemistry">View on GitHub</a>

          <h1 id="project_title">A data driven, Quantum Mechanical understanding of Chemistry</h1>
          <h2 id="project_tagline">AKA Trying to make sense of 134k quantum calculations</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/beangoben/dataDrivenChemistry/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/beangoben/dataDrivenChemistry/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a id="ac-209-data-science-final-project-" class="anchor" href="#ac-209-data-science-final-project-" aria-hidden="true"><span class="octicon octicon-link"></span></a>AC 209 Data Science Final project </h1>

<h2>
<a id="by-benjamin-sanchez-lengeling-bsanchezlengelinggharvardedu" class="anchor" href="#by-benjamin-sanchez-lengeling-bsanchezlengelinggharvardedu" aria-hidden="true"><span class="octicon octicon-link"></span></a>by Benjamin Sanchez Lengeling (<a href="mailto:bsanchezlengeling@g.harvard.edu">bsanchezlengeling@g.harvard.edu</a>)</h2>

<h4>
<a id="gifs-loading-give-it-a-minute-its-worth-it" class="anchor" href="#gifs-loading-give-it-a-minute-its-worth-it" aria-hidden="true"><span class="octicon octicon-link"></span></a>(Gifs loading, give it a minute, it's worth it)</h4>

<p><img src="http://i.imgur.com/pgXt52x.gif"></p>

<p>(<em>Ab initio Molecular Dynamics of Molecules doing the Harlem Shake</em>)</p>

<h1>
<a id="contents" class="anchor" href="#contents" aria-hidden="true"><span class="octicon octicon-link"></span></a>Contents</h1>

<ul>
<li>
<a href="#the-idea">The Idea</a> </li>
<li>
<a href="#data">Data</a> </li>
<li>
<a href="#exploration-visualization">Exploration Visualization</a> </li>
<li>
<a href="#finding-patterns">Finding Patterns</a> </li>
<li>
<a href="#future-directions">Future Directions</a> </li>
<li>
<a href="#requirements">Requirements</a> </li>
</ul>

<h1>
<a id="the-idea" class="anchor" href="#the-idea" aria-hidden="true"><span class="octicon octicon-link"></span></a>The Idea</h1>

<p><strong>Can we "discover" chemistry concepts via patterns in data?</strong> 
<em>(Obviously, let me explain more about what I mean)</em></p>

<p>Molecules are small objects whose chemical behaviour is governed by physical laws (Quantum Mechancis) and the dynamics between protons and electrons. Below is Quantum Monte Carlo simulation stocastically sampling the space of possible arrangements for the electrons.
<img src="http://fat.gfycat.com/GeneralWarmheartedGopher.gif"></p>

<p>Turns out we can simulate these laws in a computer, solving the Schr√∂dinger equation to obtain molecular properties that you could otherwise obtain via an experiment.</p>

<p>Computational chemistry is finally in a position to conduct studies on hundreds or even thousands of molecules within a reasonable amount of time. That means a lot of data :).</p>

<p>Recently Ramakrishnan et Al. reported in the Journal <em>Scientific Data</em>, <a href="http://www.nature.com/articles/sdata201422">"Quantum chemistry structures and properties of 134 kilo molecules"</a> a data set 134k calculated molecules. </p>

<p>Part of the philosophy of calculating molecules on a computer is the "First Principles", "Ab-initio", "Without knowing anything" mind set, we want to predict and model reality (molecular reality that is) without previous knowledge, without empirical observations (at least to certain degree). </p>

<p><em>For example if a computer had molecules of the skin of tomato, would it know the tomato is red?</em> By simulating how light hits the molecules and bounces back we can find out the wavelength of this returned light, and find out it is actually within the spectrum of the color "red". <strong>We can predict the tomato is red "without knowing anything"</strong>.</p>

<p>The aim of this project is to play around with this dataset and see what chemistry we can learn.</p>

<h1>
<a id="data" class="anchor" href="#data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Data</h1>

<p>Dataset is hosted on <a href="http://dx.doi.org/10.6084/m9.figshare.978904">figshare</a>, it is a few hundred MB's.
Each calculation is in a specially formated text file (xyz file) which cotains the optimized geometry, the energetics and thermodynamic properties for a single molecule. There are in total 134k stable small organic molecules made up of CHONF atoms.
The first step was to parse each file as specified in the README.txt included in the data set.</p>

<p>After that I created a pandas dataframe, with a row for each molecule, containing all the information within the txt file. This data structure can easily be converted to other more information-friendly formats (excel, databases, json). 
A pandas dataframe pickle can be downloaded <a href="https://www.dropbox.com/sh/6iysi4w0xmmevlt/AABrTLUFZJvrJPDeDCzuhxJYa?dl=0">here</a>.
I also computed a few other descriptors not included in the article, such as enthalpies of Atomization and molecular weight.</p>

<p>The entire data set once filtered is a 130830 molecules by 25 features dataframe.
<img src="http://i.imgur.com/zFEFEX2.png" alt="Data Wrangling"></p>

<h1>
<a id="exploration-visualization" class="anchor" href="#exploration-visualization" aria-hidden="true"><span class="octicon octicon-link"></span></a>Exploration Visualization</h1>

<p>I carried out first an inital exploration of all variables, to see which ones were more correlated, which ones were redundant and also to classify molecules based on their rotation.</p>

<p>The variables to explore were:</p>

<ul>
<li>Size: Number of atoms, Molecular Weight, Spatial Extensivity.</li>
<li>Rotation: Rotational Constants and Clases.</li>
<li>Energetics: Internal energy, Enthalpy, Gibbs free energy, Zero Point Energy, Atomization Energies.</li>
<li>Special Properties: Electronic Band Gap, Molar Heat Capacity, Dipole Moment and Polarizability</li>
</ul>

<h2>
<a id="some-examples" class="anchor" href="#some-examples" aria-hidden="true"><span class="octicon octicon-link"></span></a>Some examples:</h2>

<p><strong>Here we have a random selection of ten molecules for the dataset</strong>:
<img src="http://i.imgur.com/6fgfTsT.png" alt="Random Selection of molecules"></p>

<p><strong>Distribution of the number of atoms on each Molecule</strong>:
<img src="http://i.imgur.com/6Bqgbu8.png" alt="Imgur"></p>

<p><strong>Distribution of the molecular weight, two groups are apparent</strong>:
<img src="http://i.imgur.com/r88fSr2.png" alt="Imgur"></p>

<p>*<em>Violinplots of Rot Constants (A,B,C) for different types of rotors *</em>
= (Asymmetrical, Linear, Oblate, Prolate and Spherical) respectively:
<img src="http://i.imgur.com/pyqfg4b.png" alt="Imgur"></p>

<p>Due to the sheer number of samples, <strong>many variables followed a normal distribution</strong> (like Heat Capacity), these types of variables can sometimes be removed for modelling since there is little variability.
<img src="http://i.imgur.com/ggdfHD9.png" alt="Imgur"></p>

<p>While other properties were much more interesting, suggesting possible clusters of molecules, here we have the <strong>Distribution of Electronic Band gaps</strong>.
<img src="http://i.imgur.com/fjCFqv0.png" alt="Imgur"></p>

<p><strong>Distribution of Enthalpies of Atomization</strong> also displays some peaks.
<img src="http://i.imgur.com/NVRfL8R.png" alt="Imgur"></p>

<h1>
<a id="finding-patterns" class="anchor" href="#finding-patterns" aria-hidden="true"><span class="octicon octicon-link"></span></a>Finding Patterns</h1>

<p><em>Machine Learning enters the foray!</em></p>

<p>Having explored the dataset we can trim and have a better idea of what types of techniques might work.
I decided to tryout to train a molecular classifier. The criteria was common substructures.
In this specific case I focused on benzene rings, which are carbon atoms arranged in form of a hexagon.
The idea was to see what type of molecular properties are going to be influenced by the presence of these substructures.</p>

<p>Here we have one molecule that does have a benzene ring and another that dosen't. Easy Peasy (lemon-squeezy).
<img src="http://i.imgur.com/7bXLKKb.png" alt="Imgur">
<strong>What if we could predict the absence or presence of this substructure via it's molecular properties, without reference of geometry?</strong> I set to do try this out.</p>

<p>Using RDKit, I did a substructure matching of this ring in all molecules, this would be for validation purposes.
And so after this I then took a sample of ~250 molecules for each class (equal representation), with Ring and without. Below are a subset of these molecules.
<img src="http://i.imgur.com/Tmnpoex.png" alt="Imgur"></p>

<p>To start the Machine Learning I reduced the number of variables from 25 to 12 using only: rot constants A, B and C, the dipole moment, polarizability, electronic bandgap, electronic spatial extent, zero point energy, 0 temperature enthalpy, Heat Capacity, molecular Weight and enthalpy of Atomization.</p>

<p>Initially I tried with a RandomForest classifier, first I had to find out the optimal number of trees to use. Using a grid search and KFold=10 cross validation I found out that the best number of estimators was 11, resulting in a really good mean score of <strong>0.928 (49)</strong>. These results can be seen below:</p>

<p><img src="http://i.imgur.com/7vPZXMi.png" alt="Imgur"></p>

<p>Then with a good estimator, I extracted the most important features used in the classification. With the idea of finding what makes "Ringed" molecules different from a random subset.</p>

<p><img src="http://i.imgur.com/kZ9PPuO.png" alt="Imgur"></p>

<p>The top 5 features were in order of increasing importance were: Heat Capacity, Molecular Weight, Zero Point Energy,
           <strong>Rotational Constant C</strong> and <strong>Electronic Band Gap</strong>!
These resulted motivated me to look at the top two features and make sense of their distribution using violinplots (Yellow="Ringed", Green="Non-Ringed".
<img src="http://i.imgur.com/r4QKt1F.png" alt="Imgur">
<img src="http://i.imgur.com/NGeVegR.png" alt="Imgur"></p>

<p>We can clearly see different distributions in both features, this can be contrasted with <strong>Molecular Weight</strong>, which is much less important, it has the has the same distribution, just slightly shifted.
<img src="http://i.imgur.com/Vb8amRk.png" alt="Imgur"></p>

<p>The electronic bandgap makes sense, this property indicated how well a material will serve as a conductor, semi-conductor or insulator. The lower the bandgap, the more conductive a material will be since the gap between the HOMO and LUMO will be small and electrons can jump from on to the other easily. The random samples have a much higher mean gap.
This maskes sense chemistry-wise. Currently there are multiple attempts to create organic semiconductors and the building blocks for these are aromatic rings composed by chains of these simple rings. 
<strong>This can be considered a small success!</strong></p>

<p>I also tried other classifers such as Naive-Bayes, K-Nearest Neighbors and Support Vector Machine. The results are summarized in the following table, in each case KFold=10 along with cross validation were used:</p>

<table>
<thead>
<tr>
<th>Method</th>
<th align="center">Mean Score</th>
<th align="right">Std Score</th>
</tr>
</thead>
<tbody>
<tr>
<td>Naive-Bayes</td>
<td align="center">0.865</td>
<td align="right">0.066</td>
</tr>
<tr>
<td>K-NN</td>
<td align="center">0.585</td>
<td align="right">0.087</td>
</tr>
<tr>
<td>SVM</td>
<td align="center">0.745</td>
<td align="right">0.121</td>
</tr>
<tr>
<td><strong>RandomForest</strong></td>
<td align="center">0.928</td>
<td align="right">0.043</td>
</tr>
</tbody>
</table>

<h1>
<a id="future-directions" class="anchor" href="#future-directions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Future Directions</h1>

<p>I only tried matching one substructure, there are many functional groups, substructures that influenced strongly the chemical behavior of a molecule.
I had a priori knowledge of this substructure, with more time it would be interesting to see if you can discover these substructures by themselves.
There are many techniques I did not try out. Also regression was not explored.
A more tough problem ywoulbe be to predict accurately all chemical properties from just the geometric coordinates and atoms list, without having to simulate the physics, atleast not entirely. </p>

<p>There is certainly much more work to be done and many venues to explore with data science and Quantum Chemistry.
For the most part I stuck to the available dataset, yet I feel there could be more interesting data embedded in the calculations which is not included in the data set.
Examples:</p>

<ul>
<li>
<strong>Frequencies</strong>, only frequencies were reported but amplitudes were not. Using amplitudes and frequencies together you could devise spectra features such as spectral centroids, brightness o cSpectrum.</li>
<li>
<strong>Coulombic Matrix</strong>, The matrix of electromagnetic interaction between different
molecules.</li>
<li>
<strong>Orbital Occupation Numbers</strong>, Occupation numbers for the electrons within the molecular orbitals.</li>
</ul>

<p>The main idea would be design and find descriptors that can not be found in a classical way, to demonstrate that quantum calculations have more conection to reality than a classical ones. (at the molecular level).</p>

<p>Anyways, had a lot of fun, here is another gif as a reward for reading.
<img src="http://giant.gfycat.com/FairWaryBactrian.gif"></p>

<h1>
<a id="requirement" class="anchor" href="#requirement" aria-hidden="true"><span class="octicon octicon-link"></span></a>Requirement</h1>

<ul>
<li>Sci-kit learn</li>
<li>Pandas</li>
<li>Matplotlib</li>
<li>Seaborn</li>
<li>Numpy</li>
<li>Ipython notebook</li>
<li>RDKit</li>
<li>Pybel and Openbabel</li>
<li>Sense of data adventure</li>
</ul>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">A data driven, Quantum Mechanical understanding of Chemistry maintained by <a href="https://github.com/beangoben">beangoben</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-36716980-3");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>


  </body>
</html>
