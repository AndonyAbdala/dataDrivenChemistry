<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="A data driven, Quantum Mechanical understanding of Chemistry : AKA Trying to make sense of 134k quantum calculations">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>A data driven, Quantum Mechanical understanding of Chemistry</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/beangoben/dataDrivenChemistry">View on GitHub</a>

          <h1 id="project_title">A data driven, Quantum Mechanical understanding of Chemistry</h1>
          <h2 id="project_tagline">AKA Trying to make sense of 134k quantum calculations</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/beangoben/dataDrivenChemistry/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/beangoben/dataDrivenChemistry/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a id="ac-209-data-science-final-project-" class="anchor" href="#ac-209-data-science-final-project-" aria-hidden="true"><span class="octicon octicon-link"></span></a>AC 209 Data Science Final project </h1>

<h3>
<a id="gifs-loading-give-a-minute-its-worth-it" class="anchor" href="#gifs-loading-give-a-minute-its-worth-it" aria-hidden="true"><span class="octicon octicon-link"></span></a>(Gifs loading, give a minute, it's worth it)</h3>

<p><img src="http://i.imgur.com/pgXt52x.gif"></p>

<p>(<em>Ab initio Molecular Dynamics of Molecules doing the Harlem Shake</em>)</p>

<h1>
<a id="contents" class="anchor" href="#contents" aria-hidden="true"><span class="octicon octicon-link"></span></a>Contents</h1>

<ul>
<li>
<a href="#the-idea">The Idea</a> </li>
<li>
<a href="#data">Data</a> </li>
<li>
<a href="#exploration-visualization">Exploration Visualization</a> </li>
<li>
<a href="#finding-patterns">Finding Patterns</a> </li>
<li>
<a href="#future-directions">Future Directions</a> </li>
</ul>

<h1>
<a id="the-idea" class="anchor" href="#the-idea" aria-hidden="true"><span class="octicon octicon-link"></span></a>The Idea</h1>

<p><strong>Can we "discover" chemistry concepts via patterns in data?</strong> 
<em>(Obviously, let me explain more about what I mean)</em></p>

<p>Molecules are small objects whose chemical behaviour is governs by physcial laws (Quantum Mechancis) and the dynamics between protons and electrons.
<img src="http://fat.gfycat.com/GeneralWarmheartedGopher.gif"></p>

<p>Turns out we can simulate these laws in a computer, solving the Schr√∂dinger equation to obtain molecular properties that you could otherwise obtain via an experiment.</p>

<p>Computational chemistry is finally in a position to conduct studies on hundreds or even thousands of molecules within a reasonable amount of time. That means a lot of data :).</p>

<p>Recently in Ramakrishnan et Al. reported in Nature Scientific Data, <a href="http://www.nature.com/articles/sdata201422">"Quantum chemistry structures and properties of 134 kilo molecules"</a> a data set 134k calculated molecules. </p>

<p>Part of the philosophy of calculating molecules on a computer is the "First Principles", "Ab-initio", "Without knowing anything" mind set, we want to predict and model reality (molecular reality that is) without previous knowledge, without emphirical observations (at least to certain degree). </p>

<p><em>For example if a computer had molecules of the skin of tomato, would it know the tomato is red?</em> By simulating how light hits the molecules and bounces back we can find out the wavelength of this returned light, and find out it is actually within the spectrum of the color "red". <strong>We can predict the tomato is red "without knowing anything"</strong>.</p>

<p>The aim of this project is to play around with this dataset and see what chemistry we can learn.</p>

<h1>
<a id="data" class="anchor" href="#data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Data</h1>

<p>Dataset is hosted on <a href="http://dx.doi.org/10.6084/m9.figshare.978904">figshare</a>, it is a few hundred MB's.
Each calculation is in a specially formated text file (xyz file) which cotains the optimized geometry, the energetics and thermodynamic properties for a single molecule. There are in total 134k stable small organic molecules made up of CHONF atoms.
The first step was to parse each file in a very specific way, as indicated in the README.txt included in the data set.</p>

<p>I created a pandas dataframe, with a row for each molecule, containing all the information within the txt file. This data structure can easily be converted to other more information-friendly formats (excel, databases, json). 
A pandas dataframe pickle can be downloaded <a href="https://www.dropbox.com/sh/6iysi4w0xmmevlt/AABrTLUFZJvrJPDeDCzuhxJYa?dl=0">here</a>.
I also computed a few other descriptors not included in the article, such as enthalpies of Atomization and molecular weight.</p>

<p>The entire data set once filtered is a 130830 molecules by 25 features.
<img src="http://i.imgur.com/zFEFEX2.png" alt="Data Wrangling"></p>

<h1>
<a id="exploration-visualization" class="anchor" href="#exploration-visualization" aria-hidden="true"><span class="octicon octicon-link"></span></a>Exploration Visualization</h1>

<p>I carried out first an inital exploration of all variables, to see which ones were more correlated, which ones were redundant and also to classify molecules based on their rotation.</p>

<p>The variables to explore were:</p>

<ul>
<li>Size: Number of atoms, Molecular Weight, Spatial Extensivity.</li>
<li>Rotation: Rotational Constants and Clases.</li>
<li>Energetics: Internal energy, Enthalpy, Gibbs free energy, Zero Point Energy, Atomization Energies.</li>
<li>Special Properties: Electronic Band Gap, Molar Heat Capacity, Dipole Moment and Polarizability</li>
</ul>

<h2>
<a id="some-examples" class="anchor" href="#some-examples" aria-hidden="true"><span class="octicon octicon-link"></span></a>Some examples:</h2>

<p><strong>Here we have a random selection of ten molecules</strong>:
<img src="http://i.imgur.com/6fgfTsT.png" alt="Random Selection of molecules"></p>

<p><strong>Distribution of the number of atoms on each Molecule</strong>:
<img src="http://i.imgur.com/6Bqgbu8.png" alt="Imgur"></p>

<p><strong>Distribution of the molecular weight, two groups are apparent</strong>:
<img src="http://i.imgur.com/r88fSr2.png" alt="Imgur"></p>

<p>*<em>Violinplots of Rot Constants (A,B,C) for different types of rotors *</em>
= (Asymmetrical, Linear, Oblate, Prolate and Spherical) respectively:
<img src="http://i.imgur.com/pyqfg4b.png" alt="Imgur"></p>

<p>Due to the sheer number of samples, <strong>many variables followed a normal distribution</strong> (like Heat Capacity), these types of variables can sometimes be removed for modelling since there is little variability.
<img src="http://i.imgur.com/ggdfHD9.png" alt="Imgur"></p>

<p>While other properties were much more interesting suggesting possible clusters of molecules here we have the *<em>Distribution of Electronic Band gaps *</em>.
<img src="http://i.imgur.com/fjCFqv0.png" alt="Imgur"></p>

<p>*<em>Distribution of Enthalpies of Atomization *</em> also displays with some peaks.
<img src="http://i.imgur.com/NVRfL8R.png" alt="Imgur"></p>

<h1>
<a id="finding-patterns-machine-learning" class="anchor" href="#finding-patterns-machine-learning" aria-hidden="true"><span class="octicon octicon-link"></span></a>Finding Patterns (Machine Learning!)</h1>

<p>Having explored the dataset we can trim and have a better idea of what types of techniques might work.
I decided to tryout to train a molecular classifiy. The criteria was common substructures.</p>

<p>I did explore matching molecules based on similarity. 
For example taking 1000 random molecules and checking out how similar they were (geometry/structure wise)</p>

<p>This goal, which is the most interesting was not met due to time constraints.
The main idea was:</p>

<ul>
<li>Search the most common functional groups, chemical substructures that contain key chemical functionality. For this purpose I wanted to use RDKit, but had problems running it. Tried to think how to formulate this with a Kmeans classifier.</li>
<li>Create a labeling for each molecule based on a molecule having the substructure or not. This would create a membership of a molecule to within different clusters.</li>
<li>Reduce dimentionality, maybe with a TruncatedSVD or finding the best features by ranking their importance via a random forest classifier.</li>
<li>See if membership into a cluster would correspond to general differences in the molecular properties.</li>
<li>Use SVM/Random Forest to create a classifier of molecular substructure based on molecular properties.</li>
</ul>

<h1>
<a id="future-directions" class="anchor" href="#future-directions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Future Directions</h1>

<p>There is certaintly much more work to be done and many venues to explore with data science and Quantum Chemistry.
For the msot part I stuck to the available dataset, yet I feel there could be more interesting data embedded in the calculations which is not included in the data set.
Examples:</p>

<ul>
<li>
<strong>Frequencies</strong>, only frequencies were reported but amplitudes were not. Using amplitudes and frequencies together you could devise spectra features such as spectral centroids, brightness o cSpectrum.</li>
<li>
<strong>Coulombic Matrix</strong>, The matrix of electromagnetic interaction between different
molecules.</li>
<li>
<strong>Orbital Occupation Numbers</strong>, Occupation numbers for the electrons within the molecular orbitals.</li>
</ul>

<p>The main idea would be design and find descriptor that can not be found in a classical way, to demonstrate that a quantum calculation has more conection to reality than a classical one. (at the molecular level).</p>

<p><img src="http://giant.gfycat.com/FairWaryBactrian.gif"></p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">A data driven, Quantum Mechanical understanding of Chemistry maintained by <a href="https://github.com/beangoben">beangoben</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
