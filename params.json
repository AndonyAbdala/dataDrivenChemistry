{"name":"A data driven, Quantum Mechanical understanding of Chemistry","tagline":"AKA Trying to make sense of 134k quantum calculations","body":"AC 209 Data Science Final project \r\n===================\r\n### (Gifs loading, give a minute, it's worth it)\r\n\r\n<img src=\"http://i.imgur.com/pgXt52x.gif\">\r\n\r\n(*Ab initio Molecular Dynamics of Molecules doing the Harlem Shake*)\r\n\r\n# Contents\r\n- [The Idea](#the-idea) \r\n- [Data](#data) \r\n- [Exploration Visualization](#exploration-visualization) \r\n- [Finding Patterns](#finding-patterns) \r\n- [Future Directions](#future-directions) \r\n\r\n\r\n# The Idea\r\n**Can we \"discover\" chemistry concepts via patterns in data?** \r\n*(Obviously, let me explain more about what I mean)*\r\n\r\nMolecules are small objects whose chemical behaviour is governs by physcial laws (Quantum Mechancis) and the dynamics between protons and electrons.\r\n<img src=\"http://fat.gfycat.com/GeneralWarmheartedGopher.gif\">\r\n\r\nTurns out we can simulate these laws in a computer, solving the Schr√∂dinger equation to obtain molecular properties that you could otherwise obtain via an experiment.\r\n\r\nComputational chemistry is finally in a position to conduct studies on hundreds or even thousands of molecules within a reasonable amount of time. That means a lot of data :).\r\n\r\nRecently in Ramakrishnan et Al. reported in Nature Scientific Data, [\"Quantum chemistry structures and properties of 134 kilo molecules\"](http://www.nature.com/articles/sdata201422) a data set 134k calculated molecules. \r\n\r\nPart of the philosophy of calculating molecules on a computer is the \"First Principles\", \"Ab-initio\", \"Without knowing anything\" mind set, we want to predict and model reality (molecular reality that is) without previous knowledge, without emphirical observations (at least to certain degree). \r\n\r\n*For example if a computer had molecules of the skin of tomato, would it know the tomato is red?* By simulating how light hits the molecules and bounces back we can find out the wavelength of this returned light, and find out it is actually within the spectrum of the color \"red\". **We can predict the tomato is red \"without knowing anything\"**.\r\n\r\nThe aim of this project is to play around with this dataset and see what chemistry we can learn.\r\n\r\n# Data\r\n\r\nDataset is hosted on [figshare](http://dx.doi.org/10.6084/m9.figshare.978904), it is a few hundred MB's.\r\nEach calculation is in a specially formated text file (xyz file) which cotains the optimized geometry, the energetics and thermodynamic properties for a single molecule. There are in total 134k stable small organic molecules made up of CHONF atoms.\r\nThe first step was to parse each file in a very specific way, as indicated in the README.txt included in the data set.\r\n\r\nI created a pandas dataframe, with a row for each molecule, containing all the information within the txt file. This data structure can easily be converted to other more information-friendly formats (excel, databases, json). \r\nA pandas dataframe pickle can be downloaded [here](https://www.dropbox.com/sh/6iysi4w0xmmevlt/AABrTLUFZJvrJPDeDCzuhxJYa?dl=0).\r\nI also computed a few other descriptors not included in the article, such as enthalpies of Atomization and molecular weight.\r\n\r\nThe entire data set once filtered is a 130830 molecules by 25 features.\r\n![Data Wrangling](http://i.imgur.com/zFEFEX2.png)\r\n\r\n# Exploration Visualization\r\nI carried out first an inital exploration of all variables, to see which ones were more correlated, which ones were redundant and also to classify molecules based on their rotation.\r\n\r\nThe variables to explore were:\r\n* Size: Number of atoms, Molecular Weight, Spatial Extensivity.\r\n* Rotation: Rotational Constants and Clases.\r\n* Energetics: Internal energy, Enthalpy, Gibbs free energy, Zero Point Energy, Atomization Energies.\r\n* Special Properties: Electronic Band Gap, Molar Heat Capacity, Dipole Moment and Polarizability\r\n\r\n## Some examples:\r\n\r\n**Here we have a random selection of ten molecules**:\r\n![Random Selection of molecules](http://i.imgur.com/6fgfTsT.png)\r\n\r\n**Distribution of the number of atoms on each Molecule**:\r\n![Imgur](http://i.imgur.com/6Bqgbu8.png)\r\n\r\n**Distribution of the molecular weight, two groups are apparent**:\r\n![Imgur](http://i.imgur.com/r88fSr2.png)\r\n\r\n**Violinplots of Rot Constants (A,B,C) for different types of rotors **\r\n= (Asymmetrical, Linear, Oblate, Prolate and Spherical) respectively:\r\n![Imgur](http://i.imgur.com/pyqfg4b.png)\r\n\r\nDue to the sheer number of samples, **many variables followed a normal distribution** (like Heat Capacity), these types of variables can sometimes be removed for modelling since there is little variability.\r\n![Imgur](http://i.imgur.com/ggdfHD9.png)\r\n\r\nWhile other properties were much more interesting suggesting possible clusters of molecules here we have the **Distribution of Electronic Band gaps **.\r\n![Imgur](http://i.imgur.com/fjCFqv0.png)\r\n\r\n**Distribution of Enthalpies of Atomization ** also displays with some peaks.\r\n![Imgur](http://i.imgur.com/NVRfL8R.png)\r\n\r\n\r\n# Finding Patterns (Machine Learning!)\r\nHaving explored the dataset we can trim and have a better idea of what types of techniques might work.\r\nI decided to tryout to train a molecular classifiy. The criteria was common substructures.\r\n\r\n\r\n\r\nI did explore matching molecules based on similarity. \r\nFor example taking 1000 random molecules and checking out how similar they were (geometry/structure wise)\r\n\r\n\r\n\r\nThis goal, which is the most interesting was not met due to time constraints.\r\nThe main idea was:\r\n* Search the most common functional groups, chemical substructures that contain key chemical functionality. For this purpose I wanted to use RDKit, but had problems running it. Tried to think how to formulate this with a Kmeans classifier.\r\n* Create a labeling for each molecule based on a molecule having the substructure or not. This would create a membership of a molecule to within different clusters.\r\n* Reduce dimentionality, maybe with a TruncatedSVD or finding the best features by ranking their importance via a random forest classifier.\r\n* See if membership into a cluster would correspond to general differences in the molecular properties.\r\n* Use SVM/Random Forest to create a classifier of molecular substructure based on molecular properties.\r\n\r\n\r\n# Future Directions\r\nThere is certaintly much more work to be done and many venues to explore with data science and Quantum Chemistry.\r\nFor the msot part I stuck to the available dataset, yet I feel there could be more interesting data embedded in the calculations which is not included in the data set.\r\nExamples:\r\n* **Frequencies**, only frequencies were reported but amplitudes were not. Using amplitudes and frequencies together you could devise spectra features such as spectral centroids, brightness o cSpectrum.\r\n* **Coulombic Matrix**, The matrix of electromagnetic interaction between different\r\nmolecules.\r\n* **Orbital Occupation Numbers**, Occupation numbers for the electrons within the molecular orbitals.\r\n\r\nThe main idea would be design and find descriptor that can not be found in a classical way, to demonstrate that a quantum calculation has more conection to reality than a classical one. (at the molecular level).\r\n\r\n<img src=\"http://giant.gfycat.com/FairWaryBactrian.gif\">\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}